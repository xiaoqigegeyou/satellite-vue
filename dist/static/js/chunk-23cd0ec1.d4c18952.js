(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23cd0ec1"],{"7b17":function(e,t,a){"use strict";a("ad17")},"8ffb":function(e,t,a){"use strict";a("a112")},a112:function(e,t,a){},aa84:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-drawer",{staticStyle:{height:"100vh"},attrs:{title:e.title,visible:e.visible,direction:"rtl","show-close":!1},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"content",domProps:{innerHTML:e._s(e.content)}})])],1)},i=[],r={data:function(){return{visible:this.drawer_visible}},props:["title","content","drawer_visible"],methods:{handleClose:function(e){e()}},watch:{drawer_visible:function(e,t){this.visible=e},visible:function(e,t){this.$emit("updateReportVisable",e)}}},o=r,s=(a("7b17"),a("2877")),l=Object(s["a"])(o,n,i,!1,null,null,null);t["a"]=l.exports},ad17:function(e,t,a){},e78c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Memory")],1)},i=[],r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("DatePicker",{ref:"picker",on:{handleSeeReport:e.handleSeeReport,switchMode:e.handleSwtichNode,getDate:e.handleClickPickerButton,firstQuery:e.setDefaultNode}})],1),e.mode?e._e():a("el-row",[a("el-col",{attrs:{span:24}},[a("el-card",[a("el-row",[a("el-col",[a("chart",{directives:[{name:"loading",rawName:"v-loading",value:e.loading1,expression:"loading1"}],ref:"memoryOption",attrs:{options:e.memoryOption,"auto-resize":!0}})],1)],1)],1)],1)],1),e.mode?e._e():a("el-row",[a("el-col",[a("el-card",[a("el-row",[a("el-col",[a("chart",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],ref:"virtualCoreOption",attrs:{options:e.virtualCoreOption,"auto-resize":!0}})],1)],1)],1)],1)],1),e.mode?a("el-row",[a("el-col",[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading3,expression:"loading3"}]},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),stripe:""}},[a("el-table-column",{attrs:{prop:"hostName",label:"节点",width:"180"}}),a("el-table-column",{attrs:{prop:"numContainers",label:"运行容器总数",width:"180"}}),a("el-table-column",{attrs:{prop:"usedMemory",label:"已使用内存（MB）"}}),a("el-table-column",{attrs:{prop:"availMemory",label:"可用内存（MB）"}}),a("el-table-column",{attrs:{prop:"usedVcore",label:"已使用vcore数"}}),a("el-table-column",{attrs:{prop:"availableVcote",label:"可用vcore数"}}),a("el-table-column",{attrs:{prop:"createdAt",label:"时间"}})],1),a("div",{staticClass:"block",staticStyle:{"margin-top":"15px"}},[a("el-pagination",{attrs:{background:"",align:"center","current-page":e.currentPage,"page-sizes":[15,20,30,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)],1):e._e(),a("Report",{attrs:{title:e.report_title,content:e.report_content,drawer_visible:e.report_visible},on:{updateReportVisable:e.updateReportVisable}})],1)},o=[],s=(a("28a5"),a("5df3"),a("4f7f"),a("ac6a"),a("96cf"),a("1da1")),l=(a("ef97"),a("0a6d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-card",{attrs:{shadow:"always"}},[a("el-date-picker",{attrs:{size:"small",type:"daterange","value-format":"timestamp","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dateValues,callback:function(t){e.dateValues=t},expression:"dateValues"}}),e._v("\n         \n    节点：\n    "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.node,callback:function(t){e.node=t},expression:"node"}},e._l(e.nodeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.domain}})})),1),e._v("\n         \n    "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.reverseMessage}},[e._v("查找")]),e._v("\n       \n    "),a("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-tickets"},on:{click:e.handleSeeReport}},[e._v("查看分析报告")]),e._v("\n         \n    显示模式：\n    "),a("el-switch",{attrs:{"active-text":"详细数据","inactive-text":"图表"},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}})],1)],1)}),c=[],d={data:function(){return{nodeList:[],dateValues:"",node:"",mode:!1}},mounted:function(){this.getNodesListData()},methods:{reverseMessage:function(){this.$emit("getDate",this.dateValues,this.node)},handleSeeReport:function(){this.$emit("handleSeeReport")},getNodesListData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("NodeJob/allNode");case 2:t=e.sent,a=t.data,console.log(a),this.nodeList=a,this.node=this.nodeList[0].domain,this.$emit("firstQuery",this.node);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},watch:{mode:function(){this.$emit("switchMode",this.mode)}}},u=d,p=a("2877"),h=Object(p["a"])(u,l,c,!1,null,null,null),f=h.exports,m=a("aa84"),b={data:function(){return{report_title:"分析报告",report_content:"",report_visible:!1,node:"",queryDate:[],memoryOption:{title:{text:"节点内存占用",left:"center"},grid:{left:"3%",containLabel:!0},tooltip:{trigger:"item",formatter:"{b} : {c}%"},xAxis:{name:"时间",type:"category",data:[]},yAxis:{name:"占用率(%)",type:"value"},dataZoom:[{show:!0,start:0,end:100},{type:"inside",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:"empty",width:30,height:"80%",showDataShadow:!1,left:"93%"}],series:[{data:[],type:"line"}]},loading1:!1,virtualCoreOption:{title:{text:"虚拟核心占用",left:"center"},grid:{left:"3%",containLabel:!0},tooltip:{trigger:"item",formatter:"{b} : {c}%"},xAxis:{name:"时间",type:"category",data:[]},yAxis:{name:"占用率(%)",type:"value"},dataZoom:[{show:!0,start:0,end:100},{type:"inside",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:"empty",width:30,height:"80%",showDataShadow:!1,left:"93%"}],series:[{data:[],type:"line",itemStyle:{normal:{lineStyle:{color:"#e79e4f"}}}}]},loading2:!1,mode:!1,tableData:[],currentPage:1,total:20,pageSize:15,loading3:!1}},components:{DatePicker:f,Report:m["a"]},mounted:function(){},methods:{handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.currentPage=1,this.pageSize=e},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.currentPage=e},handleClickPickerButton:function(e,t){null!=e&&2==e.length?(this.queryDate[0]=e[0],this.queryDate[1]=e[1]+864e5-1):this.setDefaultDate(),this.node=t,this.getMemoryOptionData(),this.getVitualCoreOptionData(),this.getNodeSatusTableData()},setDefaultNode:function(e){this.setDefaultDate(),this.node=e,this.getMemoryOptionData(),this.getVitualCoreOptionData(),this.getNodeSatusTableData()},setDefaultDate:function(){var e=new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1),t=Date.parse(e),a=Date.parse(new Date(e.getTime()-2592e6+1));this.queryDate=[a,t]},getMemoryOptionData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading1=!0,t={startTime:this.queryDate[0],endTime:this.queryDate[1],node:this.node},e.next=4,this.$http.get("nodeStatus/memory",{params:t});case 4:for(a=e.sent,n=a.data,i=[],r=[],o=0;o<n.length;o++)i.push(n[o].day),r.push(n[o].amount);this.memoryOption.xAxis.data=i,this.memoryOption.series[0].data=r,this.loading1=!1;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getVitualCoreOptionData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading2=!0,t={startTime:this.queryDate[0],endTime:this.queryDate[1],node:this.node},e.next=4,this.$http.get("nodeStatus/virtualCore",{params:t});case 4:for(a=e.sent,n=a.data,i=[],r=[],o=0;o<n.length;o++)i.push(n[o].day),r.push(n[o].amount);this.virtualCoreOption.xAxis.data=i,this.virtualCoreOption.series[0].data=r,this.loading2=!1;case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getNodeSatusTableData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading3=!0,t={startTime:this.queryDate[0],endTime:this.queryDate[1],node:this.node},e.next=4,this.$http.get("nodeStatus/table",{params:t});case 4:a=e.sent,n=a.data,this.total=n.total,this.tableData=n.list,this.loading3=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSwtichNode:function(e){this.mode=e},handleSeeReport:function(){var e=this.memoryOption.series[0].data,t=this.virtualCoreOption.series[0].data,a=this.memoryOption.xAxis.data,n=this.virtualCoreOption.xAxis.data,i=this.node,r=[],o=[],s=[],l=[],c=parseFloat((e.reduce((function(e,t){return e+t}))/e.length).toFixed(2)),d=parseFloat((t.reduce((function(e,t){return e+t}))/t.length).toFixed(2));e.forEach((function(e,t){e>90&&r.push(t),e>95&&o.push(t)})),t.forEach((function(e,t){e>90&&s.push(t),e>95&&l.push(t)}));var u=new Set,p=new Set,h=new Set,f=new Set;r.forEach((function(e){return u.add(a[e].split(" ")[0])})),o.forEach((function(e){return p.add(a[e].split(" ")[0])})),s.forEach((function(e){return h.add(n[e].split(" ")[0])})),l.forEach((function(e){return f.add(n[e].split(" ")[0])}));var m=new Date(this.queryDate[0]).format("yyyy-MM-dd"),b=new Date(this.queryDate[1]).format("yyyy-MM-dd"),v='<div style="color:#30475e;">查询时间：<b>'.concat(m,"</b> 至 <b>").concat(b,'</b></div>\n      <br/>\n      <div>节点：<span style:"color:red;"><b>').concat(i,'</b></span></div>\n      <br/>\n      <div>集群平均内存占用为：<span style="color:red;"><b>').concat(c,'</b> %<span></div>\n      <br/>\n      <div>内存占用率超过<span style="color:#ffa62b;"><b>90%</b></span>的日期有如下：</div>');u.forEach((function(e){v+='<span style="color:#ffa62b;"><b>'.concat(e,"</b>,  </span>")})),v+='</br></br><div>其中内存占用率超过<span style="color:#e40017;"><b>95%</b></span>的日期有：</div>',p.forEach((function(e){v+='<span style="color:#e40017;"><b>'.concat(e,"</b>,  </span>")})),v+="</br></br>",v+='<div>集群平均虚拟内核占用为：<span style="color:red;"><b>'.concat(d,'</b> %<span></div>\n      <br/>\n      <div>虚拟内核占用率超过<span style="color:#ffa62b;"><b>90%</b></span>的日期有如下：</div>\n      <br/>'),h.forEach((function(e){v+='<span style="color:#ffa62b;"><b>'.concat(e,"</b>,  </span>")})),v+='<br/><br/><div>其中虚拟内核占用率超过<span style="color:#e40017;"><b>95%</b></span>的日期有：</div>',f.forEach((function(e){v+='<span style="color:#e40017;"><b>'.concat(e,"</b>,  </span>")})),this.report_content=v,this.report_visible=!0},updateReportVisable:function(e){this.report_visible=e}}},v=b,g=(a("8ffb"),Object(p["a"])(v,r,o,!1,null,"c538b044",null)),y=g.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e._v("111")])},D=[],x={data:function(){return{}}},_=x,S=Object(p["a"])(_,w,D,!1,null,"ef31d95a",null),O=S.exports,k={data:function(){return{activeName:"first"}},components:{Memory:y,VirtualCore:O}},C=k,M=Object(p["a"])(C,n,i,!1,null,"441173d8",null);t["default"]=M.exports}}]);