(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-447c8709"],{"30b8":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-scrollbar",{staticStyle:{height:"120%"}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-card",{attrs:{shadow:"always"}},[r("el-row",[r("el-form",{ref:"ErrorForm",staticClass:"ErrorForm",attrs:{model:e.ErrorForm,"label-width":"80px"}},[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"任务编号"}},[r("el-input",{model:{value:e.ErrorForm.job_id,callback:function(t){e.$set(e.ErrorForm,"job_id",t)},expression:"ErrorForm.job_id"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"产品号"}},[r("el-input",{model:{value:e.ErrorForm.product_id,callback:function(t){e.$set(e.ErrorForm,"product_id",t)},expression:"ErrorForm.product_id"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"景号"}},[r("el-input",{model:{value:e.ErrorForm.scene_no,callback:function(t){e.$set(e.ErrorForm,"scene_no",t)},expression:"ErrorForm.scene_no"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"圈号"}},[r("el-input",{model:{value:e.ErrorForm.orbit_no,callback:function(t){e.$set(e.ErrorForm,"orbit_no",t)},expression:"ErrorForm.orbit_no"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"卫星"}},[r("el-select",{attrs:{placeholder:"请选择卫星"},model:{value:e.ErrorForm.satellite_name,callback:function(t){e.$set(e.ErrorForm,"satellite_name",t)},expression:"ErrorForm.satellite_name"}},[r("el-option",{key:e.ALL.satellite_name,attrs:{label:e.ALL.label,value:e.ALL.satellite_name}}),e._l(e.CluOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.satellite_name,value:e.satellite_name}})}))],2)],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"省份"}},[r("el-select",{attrs:{placeholder:"请选择省份"},model:{value:e.ErrorForm.province_name,callback:function(t){e.$set(e.ErrorForm,"province_name",t)},expression:"ErrorForm.province_name"}},[r("el-option",{key:e.ALL.code,attrs:{label:e.ALL.label,value:e.ALL.code}}),e._l(e.ProOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.province_name,value:e.code}})}))],2)],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"步骤"}},[r("el-select",{attrs:{placeholder:"请选择步骤"},model:{value:e.ErrorForm.step_name,callback:function(t){e.$set(e.ErrorForm,"step_name",t)},expression:"ErrorForm.step_name"}},[r("el-option",{key:e.ALL.id,attrs:{label:e.ALL.label,value:e.ALL.id}}),e._l(e.StepOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.step_name,value:e.id}})}))],2)],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",[r("el-button",{staticClass:"submit_btn",attrs:{type:"primary",size:"small",plain:""},on:{click:e.submitNodeForm}},[e._v("查询")]),e._v("\n                     \n                "),r("el-button",{attrs:{type:"danger",size:"small",plain:""},on:{click:e.UpdateError}},[e._v("重做")])],1)],1)],1)],1)],1)],1)],1),r("el-row",{staticClass:"top"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize),stripe:""},on:{"selection-change":e.changeFun}},[r("el-table-column",{attrs:{type:"selection"}}),r("el-table-column",{attrs:{prop:"job_id",label:"任务编号"}}),r("el-table-column",{attrs:{prop:"satellite_name",label:"卫星名"}}),r("el-table-column",{attrs:{prop:"product_id",label:"产品号"}}),r("el-table-column",{attrs:{prop:"scene_no",label:"景号"}}),r("el-table-column",{attrs:{prop:"orbit_no",label:"圈号"}}),r("el-table-column",{attrs:{prop:"province_name",label:"省份"}}),r("el-table-column",{attrs:{prop:"step_name",label:"出错步骤"}}),r("el-table-column",{attrs:{prop:"finished_time",label:"完成时间"}})],1),r("div",{staticClass:"block",staticStyle:{"margin-top":"15px"}},[r("el-pagination",{attrs:{align:"center","current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),r("el-dialog",{attrs:{title:"选择重做任务步骤",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-table",{attrs:{data:e.selectedReDoTaskList,stripe:""}},[r("el-table-column",{attrs:{property:"job_id",label:"任务编号",width:"200"}}),r("el-table-column",{attrs:{property:"step_name",label:"出错步骤",width:"200"}}),r("el-table-column",{attrs:{prop:"reDoStepId",property:"reDoStepId",label:"重做步骤"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{placeholder:"请选择步骤"},on:{change:e.change},model:{value:t.row.reDoStepId,callback:function(r){e.$set(t.row,"reDoStepId",r)},expression:"scope.row.reDoStepId"}},e._l(t.row.reDoStepsList,(function(e){return r("el-option",{key:e.id,attrs:{label:e.step_name,value:e.id}})})),1)]}}])})],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.reDoError}},[e._v("重 做")])],1)],1)],1)},a=[],s=(r("ac6a"),r("96cf"),r("1da1")),n=(r("ef97"),{data:function(){return{ErrorForm:{job_id:"",satellite_name:"-1",product_id:"",scene_no:"",orbit_no:"",province_name:"-1",step_name:"-1",finished_time:""},ALL:{label:"全部",satellite_name:"-1",code:"-1",id:"-1"},checkBoxData:[],CluOptions:[],ProOptions:[],StepOptions:[],tableData:[],currentPage:1,total:2e3,pageSize:50,dialogVisible:!1,selectedReDoTaskList:[]}},mounted:function(){this.getAllsatellite(),this.getAllprovince(),this.getAllstep(),this.getAllErrorList()},methods:{change:function(){this.selectedReDoTaskList.push({reDoStepId:-1}),this.selectedReDoTaskList.splice(this.selectedReDoTaskList.length-1,1)},showMessage:function(e,t){this.$message({type:e,message:t})},handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.currentPage=1,this.pageSize=e},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.currentPage=e},changeFun:function(e){this.checkBoxData=e},getAllsatellite:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("ErrorDispose/Allsatellite");case 2:t=e.sent,r=t.data,this.CluOptions=r;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAllprovince:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("ErrorDispose/Allprovince");case 2:t=e.sent,r=t.data,this.ProOptions=r;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAllstep:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("ErrorDispose/Allstep");case 2:t=e.sent,r=t.data,this.StepOptions=r;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAllErrorList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http.get("ErrorDispose/ErrorDisPoseData");case 2:t=e.sent,r=t.data,console.log(r),this.tableData=r;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),submitNodeForm:function(){this.getErrorList(),this.showMessage("success","查询成功")},getErrorList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r,o,a,s,n,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.ErrorForm.job_id,r=this.ErrorForm.product_id,o=this.ErrorForm.scene_no,a=this.ErrorForm.orbit_no,""==t&&(t="-1"),""==r&&(r="-1"),""==o&&(o="-1"),""==a&&(a="-1"),s="ErrorDispose/SearchErrorDisPoseData?jobId="+t+"&productId="+r+"&sceneNo="+o+"&orbitNo="+a+"&satelliteName="+this.ErrorForm.satellite_name+"&provinceId="+this.ErrorForm.province_name+"&stepId="+this.ErrorForm.step_name,e.next=11,this.$http.get(s);case 11:n=e.sent,l=n.data,this.tableData=null,this.tableData=l,this.currentPage=1;case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),UpdateError:function(){var e=this;this.selectedReDoTaskList=this.checkBoxData,0!=this.selectedReDoTaskList.length&&(this.selectedReDoTaskList.forEach((function(t){t.reDoStepId=e.findStepIdByStepName(t.step_name),t.reDoStepsList=e.getEnableReDoStepList(t.reDoStepId)})),console.log(this.selectedReDoTaskList),this.dialogVisible=!0)},findStepIdByStepName:function(e){var t=-1;return this.StepOptions.forEach((function(r){r.step_name!=e||(t=r.id)})),t},getEnableReDoStepList:function(e){var t=this.StepOptions;return t=t.filter((function(t){var r=t.id;return r<=e})),t},reDoError:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.dialogVisible=!1,t=0;case 2:if(!(t<this.selectedReDoTaskList.length)){e.next=13;break}return console.log(this.selectedReDoTaskList[t]),e.next=6,this.$http.get("ErrorDispose/redo?jobId="+this.selectedReDoTaskList[t].job_id+"&reDoStepId="+this.selectedReDoTaskList[t].reDoStepId);case 6:r=e.sent,o=r.data,o?this.$message.success("jobID:"+this.selectedReDoTaskList[t].job_id+"任务重做成功！"):this.$message.error("jobID:"+this.selectedReDoTaskList[t].job_id+"任务重做失败！"),this.getErrorList();case 10:t++,e.next=2;break;case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}}),l=n,i=(r("901e"),r("2877")),c=Object(i["a"])(l,o,a,!1,null,"165fdeff",null);t["default"]=c.exports},"34da":function(e,t,r){},"901e":function(e,t,r){"use strict";r("34da")}}]);